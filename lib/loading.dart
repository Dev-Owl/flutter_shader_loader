import 'dart:convert';
import 'dart:typed_data';

import 'dart:ui';

import 'package:umbra_flutter/umbra_flutter.dart';

/// {@template loading}
/// A Dart Shader class for the `loading` shader.
/// {@endtemplate}
class Loading extends UmbraShader {
  Loading._() : super(_cachedProgram!);

  /// {@macro loading}
  static Future<Loading> compile() async {
    // Caching the program on the first compile call.
    _cachedProgram ??= await FragmentProgram.compile(
      spirv: Uint8List.fromList(base64Decode(_spirv)).buffer,
    );

    return Loading._();
  }

  static FragmentProgram? _cachedProgram;

  Shader shader({
    required Size resolution,
    required double iTime,
  }) {
    return program.shader(
      floatUniforms: Float32List.fromList([
        iTime,
        resolution.width,
        resolution.height,
      ]),
      samplerUniforms: [],
    );
  }
}

const _spirv =
    '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';
